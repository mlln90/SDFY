(function(d){d.fn.extend({ChooseData:function(e){function n(b,c,d){a.config.target.find(b).find("li").removeClass("active");b.timer&&clearTimeout(b.timer);var h=0,g=0,e=c/20;(function D(){h++;if(20<h)return a.config.target.find(b).find("li:eq("+d+")").addClass("active"),h=0;g+=e;a.config.target.find(b).css("top",-g);b.timer=setTimeout(D,25)})()}function E(b){a.main.on("mousedown",function(c){if(k){q=!0;c.preventDefault();a.x=c.offsetX;a.startPos=c.offsetY;a.lastMove=0;switch(b){case 1:a.day=a.config.target.find(".calendar-main .calendar-panple:eq(0) ul");
a.day.top=a.day[0].offsetTop;clearInterval(a.dayTimer);a.day.find("li").removeClass("active");break;case 2:a.month=a.config.target.find(".calendar-main .calendar-panple:eq(0) ul");a.day=a.config.target.find(".calendar-main .calendar-panple:eq(1) ul");a.x<a.temp?(a.month.top=a.month[0].offsetTop,clearInterval(a.monthTimer),a.month.find("li").removeClass("active")):(a.day.top=a.day[0].offsetTop,clearInterval(a.dayTimer),a.day.find("li").removeClass("active"));break;case 3:a.year=a.config.target.find(".calendar-main .calendar-panple:eq(0) ul"),
a.month=a.config.target.find(".calendar-main .calendar-panple:eq(1) ul"),a.day=a.config.target.find(".calendar-main .calendar-panple:eq(2) ul"),a.x<a.temp?(a.year.top=a.year[0].offsetTop,clearInterval(a.yearTimer),a.year.stop(!0,!0),a.year.find("li").removeClass("active")):a.x>a.temp&&a.x<2*a.temp?(a.month.top=a.month[0].offsetTop,clearInterval(a.monthTimer),a.month.stop(!0,!0),a.month.find("li").removeClass("active")):(a.day.top=a.day[0].offsetTop,clearInterval(a.dayTimer),a.day.find("li").removeClass("active"))}F(b);
"function"==typeof a.config.callback&&a.config.callback()}})}function F(b){d("body").unbind("mousemove");d("body").on("mousemove",function(c){if(q&&k)switch(c.preventDefault(),a.movePos=c.offsetY-a.startPos,a.speed=a.movePos-a.lastMove,a.lastMove=a.movePos,b){case 1:a.day.css("top",a.day.top+a.movePos);break;case 2:a.x<a.temp?a.month.css("top",a.month.top+a.movePos):a.day.css("top",a.day.top+a.movePos);break;case 3:a.x<a.temp?a.year.css("top",a.year.top+a.movePos):a.x>a.temp&&a.x<2*a.temp?a.month.css("top",
a.month.top+a.movePos):a.day.css("top",a.day.top+a.movePos)}})}function G(b){d("body").on("mouseup",function(c){if(q)switch(q=!1,c.preventDefault(),a.endPos=c.offsetY-a.startPos,10>a.endPos&&-10<a.endPos&&(a.speed=0),b){case 1:v();break;case 2:a.x<a.temp?z():v();break;case 3:a.x<a.temp?H():a.x>a.temp&&a.x<2*a.temp?z():v()}})}function H(){a.year.swing=a.speed;a.year.endTop=a.year[0].offsetTop;a.year.speedUp=0;k=!1;a.yearTimer=setInterval(function(){var b=a.config.year.length-2;w(a.year,b);a.year.css("top",
a.year.endTop+a.year.speedUp);1>Math.abs(a.year.swing)&&(clearInterval(a.yearTimer),b=a.config.year.length-1,x(a.year,b),a.config.defaultYear=a.minYear+a.year.sl,I(a.month,!0),m(a.day,!0),a.year.animate({top:(2-a.year.sl)*a.tempHei},200,function(){k=!0;d(this).find("li:eq("+a.year.sl+")").addClass("active");r()}))},30)}function z(){a.month.swing=a.speed;a.month.endTop=a.month[0].offsetTop;a.month.speedUp=0;k=!1;a.monthTimer=setInterval(function(){var b=a.config.month.length-2;w(a.month,b);a.month.css("top",
a.month.endTop+a.month.speedUp);1>Math.abs(a.month.swing)&&(clearInterval(a.monthTimer),b=a.config.month.length-1,x(a.month,b),a.config.defaultMonth=Number(a.minMonth)+a.month.sl,a.month.animate({top:(2-a.month.sl)*a.tempHei},200,function(){k=!0;d(this).find("li:eq("+a.month.sl+")").addClass("active");r()}),m(a.day,!0))},30)}function v(){a.day.swing=a.speed;a.day.endTop=a.day[0].offsetTop;a.day.speedUp=0;k=!1;a.dayTimer=setInterval(function(){var b=a.config.day.length-2;w(a.day,b);a.day.css("top",
a.day.endTop+a.day.speedUp);1>Math.abs(a.day.swing)&&(clearInterval(a.dayTimer),b=a.config.day.length-1,x(a.day,b),a.config.defaultDay=Number(a.minDay)+a.day.sl,a.day.animate({top:(2-a.day.sl)*a.tempHei},200,function(){k=!0;d(this).find("li:eq("+a.day.sl+")").addClass("active");r()}))},30)}function r(){var b=Number(a.config.defaultYear),c=Number(a.config.defaultMonth),d=Number(a.config.defaultDay);c=10>c?"0"+c:c;d=10>d?"0"+d:d;var u=a.config.type,g=a.config.sign,e;1==u?e=d:2==u?e=c+g+d:3==u&&(e=b+
g+c+g+d);a.val(e)}function w(b,c){b.speedUp+=b.swing;b.swing*=.8;b.allTop=b.endTop+b.speedUp;b.allLen=c;b.allTop>=2*a.tempHei?(b.speedUp=2*a.tempHei-b.endTop,b.swing=0):b.allTop<=-(b.allLen*a.tempHei)&&(b.speedUp=-(b.allLen*a.tempHei)-b.endTop,b.swing=0)}function x(b,c){b.sl=parseInt(-b.allTop/a.tempHei)+2;b.surpus=-b.allTop%a.tempHei;b.surpus>a.tempHei/2&&(b.sl+=1);b.sl>=c?b.sl=c:0>=b.sl&&(b.sl=0)}function f(b){return void 0==a.param[b]?a.config[b]:a.param[b]}function p(b,c,h){d.each(b,function(a,
b){if(c==b)return e=a,!1});if(void 0==e){var e=b.length-1;1==h?a.config.defaultDay=b[e]:2==h?a.config.defaultMonth=b[e]:a.config.defaultYear=b[e]}return e}function J(b,c){d(b).empty();c=Number(c);var h="col-";1==c&&(h+=12);2==c&&(h+=6);3==c&&(h+=4);for(var e=0;e<c;e++)d("<div>").addClass("calendar-panple "+h).html("<ul></ul>").appendTo(b);1==c?m(d(b).find(".calendar-panple:eq(0) ul")[0]):2==c?(d.each(a.config.month,function(a,c){a="<li>"+c+"\u6708</li>";d(b).find(".calendar-panple:eq(0) ul").append(a)}),
m(d(b).find(".calendar-panple:eq(1) ul")[0])):3==c&&(d.each(a.config.year,function(a,c){a="<li>"+c+"\u5e74</li>";d(b).find(".calendar-panple:eq(0) ul").append(a)}),d.each(a.config.month,function(a,c){a="<li>"+c+"\u6708</li>";d(b).find(".calendar-panple:eq(1) ul").append(a)}),m(d(b).find(".calendar-panple:eq(2) ul")[0]))}function A(){var b=[],c=12,d=Number(y);a.config.defaultYear>=t&&(c=d);for(d=1;d<=c;d++)b.push(10>d?"0"+d:d);a.minMonth=b[0];return b}function B(){var b=[],c=Number(a.config.defaultMonth);
var d=2==c?0==a.config.defaultYear%4?29:28:1==c||3==c||5==c||7==c||8==c||10==c||12==c?31:30;c=Number(a.config.defaultMonth);var e=Number(y),g=Number(C);a.config.defaultYear>=t&&c>=e&&(d=g);for(c=1;c<=d;c++)b.push(10>c?"0"+c:c);a.minDay=b[0];return b}function I(b,c){d(b).empty();c&&(a.config.month=A());c=p(a.config.month,a.config.defaultMonth,2);d.each(a.config.month,function(a,c){a="<li>"+c+"\u6708</li>";d(b).append(a)});d(b).find("li:eq("+c+")").addClass("active");c=d(b)[0].offsetTop;var e=a.config.month.length;
c<=-(e-3)*a.tempHei&&(a.defaultMonth=e,d(b).animate({top:-(e-3)*a.tempHei},400,function(){d(b).find("li:eq("+(e-1)+")").addClass("active")}))}function m(b,c){d(b).empty();c&&(a.config.day=B());c=p(a.config.day,a.config.defaultDay,1);d.each(a.config.day,function(a,c){a="<li>"+c+"\u65e5</li>";d(b).append(a)});d(b).find("li:eq("+c+")").addClass("active");c=d(b)[0].offsetTop;var e=a.config.day.length;c<=-(e-3)*a.tempHei&&(a.defaultDay=e,d(b).animate({top:-(e-3)*a.tempHei},400,function(){d(b).find("li:eq("+
(e-1)+")").addClass("active")}))}var l=new Date,t=l.getFullYear(),y=10>l.getMonth()+1?"0"+(l.getMonth()+1):l.getMonth()+1,C=10>l.getDate()?"0"+l.getDate():l.getDate(),a=this;a.param=e;a.yearago=50;void 0!=e&&(a.yearago=void 0!=e.yearago?Number(e.yearago):50);a.config={target:"",sign:"-",type:3,defaultYear:t,defaultMonth:y,defaultDay:C,year:function(){for(var b=[],c=0;c<=a.yearago;c++)b.push(t-a.yearago+c);a.minYear=b[0];return b}(),callback:null};e=d(a).val().split(a.config.sign);3<=e.length?(4==
e[0].length&&(a.config.defaultYear=Number(e[0])),2==e[1].length&&(a.config.defaultMonth=Number(e[1])),2==e[2].length&&(a.config.defaultDay=Number(e[2]))):2==e.length?(2==e[0].length&&(a.config.defaultMonth=Number(e[0])),2==e[1].length&&(a.config.defaultDay=Number(e[1]))):1==e.length&&2==e[0].length&&(a.config.defaultDay=Number(e[0]));void 0!=a.param&&(a.config.target=f("target"),a.config.sign=f("sign"),a.config.type=f("type"),a.config.defaultYear=f("defaultYear"),a.config.defaultMonth=f("defaultMonth"),
a.config.defaultDay=f("defaultDay"),a.config.year=f("year"),a.config.month=f("month"),a.config.day=f("day"),a.config.callback=f("callback"));a.config.month=A();a.config.day=B();!function(){var b=d("<div>").addClass("calendar"),c=d("<div>").addClass("calendar-shade");d("<div>").addClass("calendar-shade-line").appendTo(c);d("<div>").addClass("calendar-shade-line").appendTo(c);d(c).appendTo(b);c=d("<div>").addClass("calendar-control").appendTo(b);var e=d("<div>").addClass("calendar-main row-item");J(e,
a.config.type);d(e).appendTo(b);d(a.config.target).html(b);b=a.config.type;e=p(a.config.year,a.config.defaultYear);var f=p(a.config.month,a.config.defaultMonth,2),g=p(a.config.day,a.config.defaultDay,1),k=70*(e-2),l=70*(f-2),m=70*(g-2);switch(b){case 1:n(".calendar-main .calendar-panple:eq(0) ul",m,g);break;case 2:n(".calendar-main .calendar-panple:eq(0) ul",l,f);n(".calendar-main .calendar-panple:eq(1) ul",m,g);break;case 3:n(".calendar-main .calendar-panple:eq(0) ul",k,e),n(".calendar-main .calendar-panple:eq(1) ul",
l,f),n(".calendar-main .calendar-panple:eq(2) ul",m,g)}a.main=a.config.target.find(c);a.width=d(".calendar-shade-line").width();a.tempHei=d(".calendar-shade-line").outerHeight();3>=a.config.type&&(a.temp=a.width/a.config.type);c=a.config.type;E(c);G(c);r()}();var q=!1,k=!0}})})(jQuery);